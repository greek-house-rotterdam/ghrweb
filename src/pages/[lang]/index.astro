---
import Layout from "../../layouts/Layout.astro";
import { t } from "../../i18n/ui";
import { getStaticLangPaths, type Lang } from "../../i18n/utils";
import { getCollection } from "astro:content";

export const getStaticPaths = getStaticLangPaths;

const { lang } = Astro.params as { lang: Lang };

const allNews = await getCollection("news");
const news = allNews
  .filter((post) => post.data.lang === lang)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);

const allEvents = await getCollection("events");
const events = allEvents
  .filter((event) => event.data.lang === lang)
  .sort((a, b) => a.data.date.getTime() - b.data.date.getTime())
  .slice(0, 3);
---

<Layout title="Greek House in Rotterdam" lang={lang}>
  <!-- Hero -->
  <section class="bg-blue-50 py-16">
    <div class="mx-auto max-w-7xl px-4 text-center">
      <h1 class="text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl">
        Greek House in Rotterdam
      </h1>
      <p class="mt-4 text-lg text-gray-600">
        80+ years of Greek culture in the Netherlands
      </p>
      <div class="mt-8 flex justify-center gap-4">
        <a
          href={`/${lang}/become-a-member`}
          class="rounded-md bg-blue-600 px-6 py-3 text-white font-medium hover:bg-blue-700 transition-colors"
        >
          {t(lang, "nav.become-a-member")}
        </a>
        <a
          href={`/${lang}/contact`}
          class="rounded-md border border-gray-300 px-6 py-3 font-medium hover:bg-gray-50 transition-colors"
        >
          {t(lang, "nav.contact")}
        </a>
      </div>
    </div>
  </section>

  <!-- News -->
  <section class="py-12">
    <div class="mx-auto max-w-7xl px-4">
      <h2 class="text-2xl font-bold text-gray-900">{t(lang, "nav.news")}</h2>
      <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {news.map((post) => (
          <a
            href={`/${lang}/news/${post.id.split("/").pop()}`}
            class="block rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow"
          >
            <time class="text-sm text-gray-500">{post.data.date.toLocaleDateString(lang)}</time>
            <h3 class="mt-2 text-lg font-semibold">{post.data.title}</h3>
            <p class="mt-1 text-sm text-gray-600">{post.data.description}</p>
          </a>
        ))}
      </div>
      <div class="mt-6">
        <a href={`/${lang}/news`} class="text-blue-600 hover:underline text-sm">
          {t(lang, "common.read-more")} ‚Üí
        </a>
      </div>
    </div>
  </section>

  <!-- Events -->
  <section class="bg-gray-50 py-12">
    <div class="mx-auto max-w-7xl px-4">
      <h2 class="text-2xl font-bold text-gray-900">{t(lang, "nav.events")}</h2>
      <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {events.map((event) => (
          <a
            href={`/${lang}/events/${event.id.split("/").pop()}`}
            class="block rounded-lg border border-gray-200 bg-white p-6 hover:shadow-md transition-shadow"
          >
            <time class="text-sm text-gray-500">{event.data.date.toLocaleDateString(lang)}</time>
            <h3 class="mt-2 text-lg font-semibold">{event.data.title}</h3>
            <p class="mt-1 text-sm text-gray-600">{event.data.description}</p>
            {event.data.location && (
              <p class="mt-2 text-xs text-gray-400">üìç {event.data.location}</p>
            )}
          </a>
        ))}
      </div>
    </div>
  </section>
</Layout>
