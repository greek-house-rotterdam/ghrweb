---
import Layout from "../../../layouts/Layout.astro";
import { LANGUAGES, type Lang } from "../../../i18n/utils";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const allNews = await getCollection("news");
  return allNews.map((post) => {
    const lang = post.id.split("/")[0];
    const slug = post.id.split("/").slice(1).join("/");
    return { params: { lang, slug }, props: { post } };
  });
}

const { post } = Astro.props;
const { lang } = Astro.params as { lang: Lang };
const { Content } = await render(post);
---

<Layout title={post.data.title} description={post.data.description} lang={lang}>
  <article class="py-12">
    <div class="mx-auto max-w-3xl px-4">
      <a href={`/${lang}/news`} class="text-sm text-blue-600 hover:underline">‚Üê Back</a>
      <time class="mt-4 block text-sm text-gray-500">
        {post.data.date.toLocaleDateString(lang)}
      </time>
      <h1 class="mt-2 text-3xl font-bold text-gray-900">{post.data.title}</h1>
      <div class="prose mt-8 max-w-none">
        <Content />
      </div>
    </div>
  </article>
</Layout>
