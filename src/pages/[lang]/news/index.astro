---
import Layout from "../../../layouts/Layout.astro";
import { t } from "../../../i18n/ui";
import { getStaticLangPaths, type Lang } from "../../../i18n/utils";
import { getCollection } from "astro:content";

export const getStaticPaths = getStaticLangPaths;

const { lang } = Astro.params as { lang: Lang };

const allNews = await getCollection("news");
const news = allNews
  .filter((post) => post.data.lang === lang)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout title={t(lang, "nav.news")} lang={lang}>
  <section class="py-12">
    <div class="mx-auto max-w-7xl px-4">
      <h1 class="text-3xl font-bold text-gray-900">{t(lang, "nav.news")}</h1>
      <div class="mt-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {news.map((post) => (
          <a
            href={`/${lang}/news/${post.id.split("/").pop()}`}
            class="block rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow"
          >
            <time class="text-sm text-gray-500">{post.data.date.toLocaleDateString(lang)}</time>
            <h3 class="mt-2 text-lg font-semibold">{post.data.title}</h3>
            <p class="mt-1 text-sm text-gray-600">{post.data.description}</p>
          </a>
        ))}
      </div>
    </div>
  </section>
</Layout>
